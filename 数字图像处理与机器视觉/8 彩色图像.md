## 彩色图像基础
可视光区的波长在400nm ~ 700nm，当光谱采样限制到三个人类视觉系统敏感的红、绿、蓝光波段时，对这三个光谱带的光能量进行采样，就可以得到一幅彩色图像。
![[数字图像处理与机器视觉/assets/Pasted image 20250417030426.png]]
![[数字图像处理与机器视觉/assets/Pasted image 20250417030445.png]]
## 彩色颜色模型
颜色的描述是通过建立色彩模型来实现的，不同的色彩模型对应于不同的处理目的。
### CIE XYZ
CIE（国际照明委员会）提出的标准颜色模型.
基于人眼的三元色理论，假设人眼有三个独立的感光细胞，分别对红、绿、蓝光敏感.

三刺激值（X, Y, Z）表示颜色的物理属性.
适用于颜色匹配和标准化.
![[数字图像处理与机器视觉/assets/Pasted image 20250417031521.png]]
### CIE Lab
Lab颜色空间是在1976年制定的等色空间，以克服在x，y色度图上相等的距离并不相当于我们所觉察到的相等色差的问题.
![[数字图像处理与机器视觉/assets/Pasted image 20250417031531.png]]
### RGB
以700nm(红)、546.1nm (绿)、435.8nm (蓝)三个色光为三基色,又称为物理三基色.通过这三基色按不同比例混合而成,便是RGB色系.
![[数字图像处理与机器视觉/assets/Pasted image 20250417031541.png]]
### HSI色系
- H（色度）：表示颜色的基本色调，0°为红色，120°为绿色，240°为蓝色。
- S（饱和度）：表示颜色的纯度，从0（灰色）到1（纯色）。
- I（亮度）：表示颜色的亮度，与颜色无关。

HSI色系设计符合人眼对颜色的感知方式.
### HSI与RGB的相互转换
#### RGB转HSI
$$\begin{aligned}&I=\frac{1}{\sqrt{3}}\left(R+G+B\right)\\&S=1-\frac{3\min(R,G,B)}{R+G+B}\\
&H=\begin{cases}\theta&G\geq B\\2\pi\theta&G\leq B&\end{cases}\quad\theta=\cos^{-1}\left[\frac{\frac{1}{2}[(R-G)+(R-B)]}{\sqrt{(R-G)^2+(R-B)(G-B)}}\right]\end{aligned}$$
#### HSI转RGB
1. 当0°≤H≤120°时$$\begin{aligned}&R=\frac{I}{\sqrt{3}}[1+\frac{S\cos(H)}{\cos(60^\circ-H)}]\\&B=\frac{I}{\sqrt{3}}(1-S)\\&G=\sqrt{3}I-R-B\end{aligned}$$
2. 当120°≤H≤240°时$$\begin{aligned}&G=\frac{I}{\sqrt{3}}[1+\frac{S\operatorname{cos}(H-120^{\circ})}{\operatorname{cos}(180^{\circ}-H)}]\\&R=\frac{I}{\sqrt{3}}(1-S)\\&B=\sqrt{3}I-R-G\end{aligned}$$
3. 当240°≤H＜300°时$$\begin{aligned}&B=\frac{I}{\sqrt{3}}[1+\frac{S\cos(H-240^\circ)}{\cos(300^\circ-H)}]\\&G=\frac{I}{\sqrt{3}}(1-S)\\&R=\sqrt{3}I-G-B\end{aligned}$$
*300°~360°之间为非可见光谱色，没有定义*
### YUV电视信号表色系
Y为亮度,U和V为色差信号.
设计目的是为了与黑白电视兼容.
### YUV与RGB的相互转换
#### RGB转YUV
$$\begin{aligned}&Y=0.299R+0.587G+0.114B\\&U=B-Y\\&V=R-Y\end{aligned}$$
#### YUV转RGB
$$\begin{aligned}&R=Y+V\\&G=Y-0.192U-0.509V\\&B=Y+U\end{aligned}$$
### YCbCr表色系
Y代表亮度,Cb,Cr为色差.

与YUV表色系统不同的是它充分考虑了色彩组成时RGB三色的重要因素。
YUV考虑的是色系转换的简单；YCbCr考虑的是压缩时可以充分取出冗余量。
### YCbCr与RGB的相互转换
#### RGB转YCbCr
$$\begin{aligned}&Y=0.299R+0.587G+0.114B\\&C_b=2(1-0.114)(B-Y)\\&Cr=2(1-0.299)(R-Y)\end{aligned}$$
#### YCbCr转RGB
$$\begin{aligned}&k_r=\frac{1}{2(1-0.299)}\quad k_b=\frac{1}{2(1-0.114)}\\&R=Y+k_r\cdot C_r\\&B=Y+k_b\cdot C_b\\&G=Y-0.299/0.587*k_{r}C_{r}-0.114/0.587*k_{b}C_{b}\end{aligned}$$
## 彩色图像处理
对于彩色图像,处理的方法是，将同样的操作在R,G, B三个分量上分别进行.
### 彩色补偿
由于常用的彩色图像设备具有较宽而且相互覆盖的光谱敏感区，加上待拍摄图像的染色是变化的，所以很难在三个分量图中将物体分离出来。这种现象称为颜色扩散.
#### 彩色补偿算法
1. 在画面上找到主观视觉看是纯红、绿、蓝的三个点。如果画面上没有，则做靶图（包括纯红、绿、蓝）进行拍摄.
2. 计算R* G* B\*的值
   由于亮度不变,采取下面操作$$\left.\left\{\begin{array}{c}R^*=0.30\cdot R_1+0.59\cdot G_1+0.11\cdot B_1\\G^*=0.30\cdot R_2+0.59\cdot G_2+0.11\cdot B_2\\B^*=0.30\cdot R_3+0.59\cdot G_3+0.11\cdot B_3\end{array}\right.\right.$$
3. 构造变换矩阵
   构建两个矩阵:$$A_1=\begin{bmatrix}R_1&R_2&R_3\\G_1&G_2&G_3\\B_1&B_2&B_3\end{bmatrix}\quad A_2=\begin{bmatrix}R^*&0&0\\0&G^*&0\\0&0&B^*\end{bmatrix}$$
4. 进行彩色补偿
   设新旧图像像素值分别为:$$S\left(i,j\right)=\begin{bmatrix}R_s\left(i,j\right)\\G_s\left(i,j\right)\\B_s\left(i,j\right)\end{bmatrix}\quad F\left(i,j\right)=\begin{bmatrix}R_F\left(i,j\right)\\G_F\left(i,j\right)\\B_F\left(i,j\right)\end{bmatrix}$$
   则$$\begin{aligned}S\left(i,j\right)&=C^{-1}*F\left(i,j\right)\\\\\text{其中:}&C=A_1*A_2^{-1}\end{aligned}$$
彩色补偿的作用:通过不同的颜色通道提取不同的目标物.
### 彩色平衡
一副彩色图像中,色通道的不同敏感度、增光因子、偏移量等原因可能导致三基色不平衡,导致显示时颜色不正常;因此需要将其矫正,称为彩色平衡.
#### 彩色平衡算法
1. 从画面中选出两点为灰色的点,设为:$$F_1=(R_1,G_1,B_1)\quad F_2=(R_2,G_2,B_2)$$
2. 设以G分量为基准,匹配R和B分量.$$Y_1=0.299\cdot R_1+0.587\cdot G_1+0.114\cdot B_1\quad Y_2=0.299\cdot R_2+0.587\cdot G_2+0.114\cdot B_2$$$$F_1^*=(Y_1,Y_1,Y_1)F_2^*=(Y_2,Y_2,Y_2)$$
3. 由$$\begin{aligned}&R_1^*=k1^*R_1+k2&&\text{求出:k1和k2}\\&R_2^*=k1^*R_2+k2\\&B_1^*=l1^*B_1+l2&&\text{求出:l1和l2}\\&B_2^*=l1^*B_2+l2\end{aligned}$$
4. $$\begin{aligned}&R(i,j)^*=k1^*R(i,j)+k2\\&B(i,j)^*=l1^*B(i,j)+l2\\&G(i,j)^*=G(i,j)\end{aligned}$$可得彩色平衡后的图像.